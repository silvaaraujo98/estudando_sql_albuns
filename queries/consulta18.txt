-- Obter o TM por Ano

WITH orders_sales_by_year AS
  (SELECT strftime('%Y', invoicedate) AS YEAR,
          COUNT(invoiceid) AS orders,
          SUM(total) AS sales
   FROM invoice
   GROUP BY YEAR)
SELECT YEAR,
       round(sales/orders, 3)
FROM orders_sales_by_year;