-- Qual a frequÃªncia dos clientes por Ano
 WITH sales_clientes_by_year AS
  (SELECT strftime('%Y', invoicedate) AS YEAR,
          CAST(COUNT(invoiceid) AS REAL) AS sales,
          CAST(COUNT(DISTINCT(customerid)) AS REAL) AS number_of_clientes
   FROM invoice
   GROUP BY YEAR)
SELECT YEAR,
       ROUND(sales/number_of_clientes, 3) AS frequency
FROM sales_clientes_by_year;